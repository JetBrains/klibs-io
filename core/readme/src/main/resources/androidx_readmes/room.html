<h1>Room</h1>
<p>The Room persistence library provides an abstraction layer over SQLite to allow for more robust database access while harnessing the full power of SQLite.</p>
<p>[<a href="https://developer.android.com/training/data-storage/room" rel="nofollow">User Guide</a>]</p>
<p>[<a href="https://developer.android.com/reference/kotlin/androidx/room/package-summary" rel="nofollow">API Reference</a>]</p>
<h2>Declaring dependencies</h2>
<p>To add a dependency on Room, you must add the Google Maven repository to your project. Read <a href="https://developer.android.com/studio/build/dependencies#google-maven" rel="nofollow">Google's Maven repository</a> for more information.</p>
<p>Add the dependencies for the artifacts you need in the <code class="notranslate">build.gradle</code> file for your app or module:</p>
<h3>Kotlin</h3>
<div class="highlight highlight-source-kotlin"><pre class="notranslate">dependencies {
    <span class="pl-k">val</span> room_version <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>2.8.4<span class="pl-pds">"</span></span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-runtime:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> If this project uses any Kotlin source, use Kotlin Symbol Processing (KSP)</span>
    ksp(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-compiler:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - Kotlin Extensions and Coroutines support for Room</span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-ktx:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - RxJava2 support for Room</span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-rxjava2:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - RxJava3 support for Room</span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-rxjava3:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - Guava support for Room, including Optional and ListenableFuture</span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-guava:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - Test helpers</span>
    testImplementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-testing:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> optional - Paging 3 Integration</span>
    implementation(<span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-paging:<span class="pl-e">$room_version</span><span class="pl-pds">"</span></span>)
}</pre></div>
<details>
<summary><b>Groovy</b></summary>
<div class="highlight highlight-source-groovy"><pre class="notranslate">dependencies {
    <span class="pl-k">def</span> room_version <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>2.8.4<span class="pl-pds">"</span></span>
    implementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-runtime:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> If this project uses any Kotlin source, use Kotlin Symbol Processing (KSP)</span>
    ksp <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-compiler:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> If this project only uses Java source, use the Java annotationProcessor</span>
    annotationProcessor <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-compiler:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> optional - RxJava2 support for Room</span>
    implementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-rxjava2:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> optional - RxJava3 support for Room</span>
    implementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-rxjava3:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> optional - Guava support for Room, including Optional and ListenableFuture</span>
    implementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-guava:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> optional - Test helpers</span>
    testImplementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-testing:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
    <span class="pl-c"><span class="pl-c">//</span> optional - Paging 3 Integration</span>
    implementation <span class="pl-s"><span class="pl-pds">"</span>androidx.room:room-paging:<span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span>
}</pre></div>
</details>
<p>For information on using the KAPT plugin, see the <a href="https://kotlinlang.org/docs/kapt.html" rel="nofollow">KAPT documentation</a>.</p>
<p>For information on using the KSP plugin, see the <a href="https://developer.android.com/build/migrate-to-ksp" rel="nofollow">KSP quick-start documentation</a>.</p>
<p>For information on using Kotlin extensions, see the <a href="https://developer.android.com/kotlin/ktx" rel="nofollow">ktx documentation</a>.</p>
<p>For more information about dependencies, see <a href="https://developer.android.com/studio/build/dependencies" rel="nofollow">Add Build Dependencies</a>.</p>
<p>Optionally, for non-Android libraries (i.e. Java or Kotlin only Gradle modules)<br>
you can depend on androidx.room:room-common to use Room annotations.</p>
<h2>Configuring Compiler Options</h2>
<p>Room has the following annotation processor options.</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code class="notranslate">room.schemaLocation</code></td>
<td>directory. Enables exporting database schemas into JSON files in the given directory. See <a href="https://developer.android.com/training/data-storage/room/migrating-db-schemas" rel="nofollow">Room Migrations</a> for more information.</td>
</tr>
<tr>
<td><code class="notranslate">room.incremental</code></td>
<td>boolean. Enables Gradle incremental annotation processor. Default value is true.</td>
</tr>
<tr>
<td><code class="notranslate">room.generateKotlin</code></td>
<td>boolean. Generate Kotlin source files instead of Java. Requires KSP. Default value is true as of version 2.7.0. See <a href="https://developer.android.com/jetpack/androidx/releases/room#2.6.0" rel="nofollow">version 2.6.0 notes</a>, when it was introduced, for more details.</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>Use the Room Gradle Plugin</h2>
<p>With Room version 2.6.0 and higher, you can use the Room Gradle Plugin to<br>
configure options for the Room compiler. The plugin configures the project such<br>
that generated schemas (which are an output of the compile tasks and are<br>
consumed for auto-migrations) are correctly configured to have reproducible and<br>
cacheable builds.</p>
<p>To add the plugin, in your top-level Gradle build file, define the<br>
plugin and its version.</p>
<h3>Kotlin</h3>
<div class="highlight highlight-source-kotlin"><pre class="notranslate">plugins {
    id(<span class="pl-s"><span class="pl-pds">"</span>androidx.room<span class="pl-pds">"</span></span>) version <span class="pl-s"><span class="pl-pds">"</span><span class="pl-e">$room_version</span><span class="pl-pds">"</span></span> apply <span class="pl-c1">false</span>
}</pre></div>
<details>
<summary><b>Groovy</b></summary>
<div class="highlight highlight-source-groovy"><pre class="notranslate">plugins {
    id <span class="pl-s"><span class="pl-pds">'</span>androidx.room<span class="pl-pds">'</span></span> version <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$r<span class="pl-smi">oom_version</span></span><span class="pl-pds">"</span></span> apply <span class="pl-c1">false</span>
}</pre></div>
</details>
<p>In the module-level Gradle build file, apply the plugin and use the <code class="notranslate">room</code><br>
extension.</p>
<h3>Kotlin</h3>
<div class="highlight highlight-source-kotlin"><pre class="notranslate">plugins {
    id(<span class="pl-s"><span class="pl-pds">"</span>androidx.room<span class="pl-pds">"</span></span>)
}

android {
    <span class="pl-c"><span class="pl-c">//</span> ...</span>
    room {
        schemaDirectory(<span class="pl-s"><span class="pl-pds">"</span><span class="pl-e">$projectDir</span>/schemas<span class="pl-pds">"</span></span>)
    }
}</pre></div>
<details>
<summary><b>Groovy</b></summary>
<div class="highlight highlight-source-groovy"><pre class="notranslate">plugins {
    id <span class="pl-s"><span class="pl-pds">'</span>androidx.room<span class="pl-pds">'</span></span>
}

android {
    <span class="pl-c"><span class="pl-c">//</span> ...</span>
    room {
        schemaDirectory <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$p<span class="pl-smi">rojectDir</span></span>/schemas<span class="pl-pds">"</span></span>
    }
}</pre></div>
</details>
<p>Setting a <code class="notranslate">schemaDirectory</code> is required when using the Room Gradle Plugin. This<br>
will configure the Room compiler and the various compile tasks and its backends<br>
(javac, KAPT, KSP) to output schema files into flavored folders, for example<br>
<code class="notranslate">schemas/flavorOneDebug/com.package.MyDatabase/1.json</code>. These files should be<br>
checked into the repository to be used for validation and auto-migrations.</p>
<p>Some options cannot be configured in all versions of the Room Gradle Plugin,<br>
even though they are supported by the Room compiler. The table below lists each<br>
option and shows the version of the Room Gradle Plugin that added support for<br>
configuring that option using the <code class="notranslate">room</code> extension. If your version is lower,<br>
or if the option is not supported yet, you can use<br>
<a href="#use-annotation-processor-options">annotation processor options</a> instead.</p>
<markdown-accessiblity-table><table role="table">
<thead>
<tr>
<th>Option</th>
<th>Since version</th>
</tr>
</thead>
<tbody>
<tr>
<td><code class="notranslate">room.schemaLocation</code> (required)</td>
<td>2.6.0</td>
</tr>
<tr>
<td><code class="notranslate">room.incremental</code></td>
<td>-</td>
</tr>
<tr>
<td><code class="notranslate">room.generateKotlin</code></td>
<td>-</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<h2>Use annotation processor options</h2>
<p>If you aren't using the Room Gradle Plugin, or if the option you want isn't<br>
supported by your version of the plugin, you can configure Room using<br>
annotation processor options, as described in<br>
<a href="https://developer.android.com/studio/build/dependencies" rel="nofollow">Add build dependencies</a>. How you<br>
specify annotation options depends on whether you use KSP or KAPT for Room.</p>
<h3>Kotlin</h3>
<div class="highlight highlight-source-kotlin"><pre class="notranslate"><span class="pl-c"><span class="pl-c">//</span> For KSP</span>
ksp {
    arg(<span class="pl-s"><span class="pl-pds">"</span>option_name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>option_value<span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> other options...</span>
}

<span class="pl-c"><span class="pl-c">//</span> For javac and KAPT</span>
android {
    <span class="pl-c"><span class="pl-c">//</span> ...</span>
    defaultConfig {
        <span class="pl-c"><span class="pl-c">//</span> ...</span>
        javaCompileOptions {
            annotationProcessorOptions {
                arguments <span class="pl-k">+</span><span class="pl-k">=</span> <span class="pl-c1">mapOf</span>(
                    <span class="pl-s"><span class="pl-pds">"</span>option_name<span class="pl-pds">"</span></span> to <span class="pl-s"><span class="pl-pds">"</span>option_value<span class="pl-pds">"</span></span>,
                    <span class="pl-c"><span class="pl-c">//</span> other options...</span>
                )
            }
        }
    }
}</pre></div>
<details>
<summary><b>Groovy</b></summary>
<div class="highlight highlight-source-groovy"><pre class="notranslate"><span class="pl-c"><span class="pl-c">//</span> For KSP</span>
ksp {
    arg(<span class="pl-s"><span class="pl-pds">"</span>option_name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>option_value<span class="pl-pds">"</span></span>)
    <span class="pl-c"><span class="pl-c">//</span> other options...</span>
}

<span class="pl-c"><span class="pl-c">//</span> For javac and KAPT</span>
android {
    <span class="pl-c"><span class="pl-c">//</span> ...</span>
    defaultConfig {
        <span class="pl-c"><span class="pl-c">//</span> ...</span>
        javaCompileOptions {
            annotationProcessorOptions {
                arguments <span class="pl-k">+</span><span class="pl-k">=</span> [
                    <span class="pl-s"><span class="pl-pds">"</span>option_name<span class="pl-pds">"</span></span>:<span class="pl-s"><span class="pl-pds">"</span>option_value<span class="pl-pds">"</span></span>,
                    <span class="pl-c"><span class="pl-c">//</span> other options...</span>
                ]
            }
        }
    }
}</pre></div>
</details>
<p>Because <code class="notranslate">room.schemaLocation</code> is a directory and not a primitive type, it is<br>
necessary to use a <code class="notranslate">CommandLineArgumentsProvider</code> when adding this option so<br>
that Gradle knows about this directory when conducting up-to-date checks.<br>
<a href="https://developer.android.com/training/data-storage/room/migrating-db-versions#set_schema_location_using_annotation_processor_option" rel="nofollow">Migrate your Room database</a><br>
shows a complete implementation of <code class="notranslate">CommandLineArgumentsProvider</code> that provides<br>
the schema location.</p>
<h2>Issue tracker</h2>
<p><a href="https://issuetracker.google.com/issues?q=componentid:413107" rel="nofollow">Issue Tracker</a></p>